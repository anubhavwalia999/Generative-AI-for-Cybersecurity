## üéØ Objective: Analyze obfuscated Python malware code and determine its function

### üîπ Prompt
"You're a malware analyst. Analyze the following Python code snippet. Decode its purpose and outline the risks.

Code:
```python
from docx import Document
import os

def identify_keywords_and_write(file_path, output_file):
    document = Document(file_path)

    has_keywords = any("nuclear" in paragraph.text.lower() and "research" in paragraph.text.lower() for paragraph in document.paragraphs)

    if has_keywords:
        with open(output_file, 'a') as output:
            output.write(os.path.basename(file_path) + '\n')

def process_directory(directory_path, output_file):
    for filename in os.listdir(directory_path):
        if filename.endswith(".docx"):
            file_path = os.path.join(directory_path, filename)
            identify_keywords_and_write(file_path, output_file)

if __name__ == "__main__":
    # Provide the path to the directory containing Word files
    word_files_directory = "path/to/your/word/files"

    # Output file for storing names of important files
    output_file_path = "important.doc"

    for file_name in os.listdir(word_files_directory):
        if file_name.endswith(".docx"):
            file_path = os.path.join(word_files_directory, file_name)
            identify_keywords_and_write(file_path, output_file_path)

    print("Process completed. Check 'important.doc' for results.")
```

# üß™ Malware Analysis: DOCX Keyword Scanner

## üß† Purpose Analysis

This Python script searches through `.docx` Word documents in a specified directory, looking for files that contain both the words **"nuclear"** and **"research"**. If such content is found, it logs the filename into a separate file named `important.doc`.

---

## üîç Functionality Summary

- Uses the `python-docx` library to parse text content in Word documents.
- Performs keyword matching using simple conditional logic.
- Writes names of matching files to a local text file.

---

## ‚ö†Ô∏è Risk Assessment

- **Potential Insider Threat Tool**: This script could be weaponized by a malicious insider to automate the discovery of sensitive documents (e.g., related to nuclear research) on a corporate or classified network.
- **Silent Data Mapping**: While it doesn't exfiltrate files directly, it silently builds a list of sensitive files, which could later be copied or transferred.
- **Low Detection Footprint**: The script is lightweight and doesn‚Äôt require admin privileges, making it easy to execute without detection on most systems.
- **Disguisable Intent**: Since it uses a legitimate library and performs standard file I/O, it may evade security tools that don't inspect script logic.

---

## üîê Mitigation Recommendations

- Monitor script execution in sensitive directories.
- Use DLP (Data Loss Prevention) tools to detect unauthorized scanning.
- Audit `.docx` access logs on high-security endpoints.

---

## üìå Verdict

**Suspicious/Reconnaissance Behavior** ‚Äî While not inherently malicious, this script fits the profile of **Stage 1 reconnaissance malware** or an **insider threat tool** aimed at identifying valuable targets for future exfiltration or exploitation.
